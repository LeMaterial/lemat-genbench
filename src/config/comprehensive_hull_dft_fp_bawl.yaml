type: comprehensive_hull_dft

# This config runs all benchmark families using multi-MLIP ensemble with DFT hull
# Each MLIP calculates energies with respect to the DFT hull for consistency
# Validity benchmark and preprocessor are ALWAYS run automatically

# Validity benchmark settings (always run - updated to match new implementation)
validity_settings:
  charge_tolerance: 0.1
  distance_scaling: 0.5
  min_atomic_density: 0.00001
  max_atomic_density: 0.5
  min_mass_density: 0.01
  max_mass_density: 25.0
  check_format: true
  check_symmetry: true

# Distribution benchmark settings
mlips: ["orb", "mace", "uma"]
cache_dir: "./data"
js_distributions_file: "data/lematbulk_jsdistance_distributions.json"
mmd_values_file: "data/lematbulk_mmd_values_15k.pkl"

# Fingerprinting method configuration
fingerprint_method: "short-bawl"

# Novelty benchmark settings (using short-bawl)
novelty_settings:
  reference_dataset: "LeMaterial/LeMat-Bulk"
  reference_config: "compatible_pbe"
  cache_reference: true
  max_reference_size: null
  n_jobs: 1

# Uniqueness benchmark settings (using short-bawl)
uniqueness_settings:
  n_jobs: 1

# SUN benchmark settings (using short-bawl)
sun_settings:
  stability_threshold: 0.0
  metastability_threshold: 0.1
  include_metasun: true
  reference_dataset: "LeMaterial/LeMat-Bulk"
  reference_config: "compatible_pbe"
  cache_reference: true
  max_reference_size: null

# HHI benchmark settings
hhi_settings:
  production_weight: 0.25
  reserve_weight: 0.75
  scale_to_0_10: true

# Multi-MLIP stability settings with DFT hull calculations
stability_settings:
  use_ensemble: true
  metastable_threshold: 0.1
  ensemble_config:
    min_mlips_required: 2
  individual_mlip_config:
    use_all_available: true
    require_all_mlips: false
    fallback_to_single: true

# Preprocessor configuration for multi-MLIP hull calculations with DFT hull
preprocessor_config:
  model_name: multi_mlip
  mlip_configs:
    orb:
      model_type: orb_v3_conservative_inf_omat
      device: cpu
      hull_type: dft  # Use DFT hull for consistency
    mace:
      model_type: mp
      device: cpu
      hull_type: dft  # Use DFT hull for consistency
    uma:
      task: omat
      device: cpu
      hull_type: dft  # Use DFT hull for consistency
  relax_structures: true
  relaxation_config:
    fmax: 0.02
    steps: 50
  calculate_formation_energy: true
  calculate_energy_above_hull: true  # This will use DFT hull for all MLIPs
  extract_embeddings: true
  timeout: 300

# Reporting configuration
reporting:
  include_individual_mlip_results: true    # Show per-model results alongside ensemble results
  include_uncertainty_analysis: true       # Include std deviation in results
  include_ensemble_summary: true           # Include ensemble quality summary

# Metadata
description: "Comprehensive benchmark configuration using multi-MLIP ensemble with DFT hull and short-BAWL fingerprinting"
version: "1.0.0"
metadata:
  reference: "Comprehensive evaluation using DFT convex hull for all MLIPs"
  use_case: "Full evaluation across validity, distribution, novelty, uniqueness, and stability metrics using DFT hull"
  fingerprinting_method: "short-bawl"
  preprocessing_required: true
  hull_calculation_method: "dft-consistent"
  notes:
    - "Validity benchmark and preprocessor are ALWAYS run automatically"
    - "Uses short-BAWL fingerprinting for novelty, uniqueness, and SUN metrics"
    - "All MLIPs calculate energies with respect to the same DFT convex hull"
    - "Ensemble statistics computed from DFT hull energies across all MLIPs"
    - "Individual MLIP results reported alongside ensemble results"
    - "Consistent stability evaluation using DFT reference data"
  performance_characteristics:
    - "Preprocessing: Multi-MLIP calculations with DFT hull energies"
    - "High consistency: All models use same DFT convex hull"
    - "Memory intensive: Requires loading multiple MLIP models"
    - "Computationally intensive: Full MLIP calculations + hull lookups"
    - "Faster fingerprinting: short-BAWL is faster than structure-matcher"
  recommended_usage:
    - "Research applications requiring consistent stability evaluation across MLIPs"
    - "When comparing different MLIPs on equal footing"
    - "Ensemble-based stability assessment with DFT reference"
    - "Comparative analysis without model-specific hull bias"
    - "When speed is important (short-BAWL faster than structure-matcher)"
  limitations:
    - "Requires significant computational resources"
    - "Slower than single-MLIP approaches"
    - "Memory intensive due to multiple model loading"
  accuracy_benefits:
    - "Consistent DFT hull reference for all MLIPs"
    - "Eliminates model-specific hull biases"
    - "Provides uncertainty quantification through ensemble statistics"
    - "Fair comparison across different MLIP architectures"
